<header class="bg-blue-planning-100">
  <div class="p-6 pb-2 lg:pb-6 center-container">
    <.crumbs>
      <:crumb to={Routes.job_path(@socket, @live_action)}>
        <%= action_name(@live_action, :plural) %>
      </:crumb>

      <:crumb><%= Job.name @job %></:crumb>
    </.crumbs>

    <hr class="mt-2 border-white" />

    <.status_badge job_status={@job.job_status} class="inline-block mt-7" />

    <h1 class="flex items-center justify-between text-3xl font-bold lg:justify-start">
      <%= Job.name @job %>

      <button title="Manage" type="button" phx-click="manage" class="relative inline-block h-5 ml-4 text-2xl font-bold border rounded w-9 leading-3 border-blue-planning-300 text-blue-planning-300">
        <div class="absolute -top-1.5 left-1.5">&hellip;</div>
      </button>
    </h1>
  </div>
</header>

<.subheader package={@package} job={@job} />

<div class="p-6 center-container" {intro_hints_only("intro_hints_only_cards")}>
  <ul class="grid gap-5 grid-cols-2 lg:grid-cols-4">
    <.overview_card title="Finances" icon="money-bags-outline" button_text="Send reminder" button_click="open-compose" hint_content="See the status of payment from your client at a glance. If they're past due or you to need to follow up, send them a reminder message.">
      <dl class="grid grid-cols-2">
        <dt class="text-xs font-bold tracking-widest text-gray-400 uppercase">Paid</dt>
        <%= if BookingProposal.remainder_paid?(@proposal) do %>
          <dd class="font-bold row-start-2 text-green-finances-300"><%= Package.price(@package) |> Money.to_string(fractional_unit: false) %></dd>
        <% else %>
          <dd class="font-bold row-start-2 text-green-finances-300"><%= Package.deposit_price(@package) |> Money.to_string(fractional_unit: false) %></dd>
          <dt class="text-xs font-bold tracking-widest text-gray-400 uppercase">Owed</dt>
          <dd class="font-bold row-start-2 text-red-sales-300"><%= Package.remainder_price(@package) |> Money.to_string(fractional_unit: false) %></dd>
        <% end %>
      </dl>
    </.overview_card>
    <.overview_card title="Inbox" icon="envelope-outline" button_text="Go to job inbox" button_click="open-inbox" hint_content="Check in on messages from your client, or send them a message">
      <%= if @inbox_count > 0 do %>
        <%= ngettext "%{count} new message", "%{count} new messages", @inbox_count %>
      <% else %>
        You are free as a bird!
      <% end %>
    </.overview_card>
    <.gallery_overview_card gallery={@job.gallery} title="Gallery" icon="gallery"/>
  </ul>

  <.notes job={@job} />

  <h2 class="mt-8 mb-3 text-xs font-semibold tracking-widest text-gray-400 uppercase">Shoot Details</h2>

  <.shoot_details shoot_path={&Routes.shoot_path(@socket, @live_action, @job.id, &1)} current_user={@current_user} shoots={@shoots} />

  <h2 class="mt-8 mb-3 text-xs font-semibold tracking-widest text-gray-400 uppercase">Booking Details</h2>

  <.proposal_details proposal={@proposal} current_user={@current_user} />
</div>
