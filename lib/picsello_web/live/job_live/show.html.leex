<div class="px-8 pt-2">
  <div class="text-xs text-gray-400">
    <%= live_redirect to: Routes.job_path(@socket, :index) do %>
      Leads
    <% end %>
    &gt;
    <%= Job.name @job %>
  </div>

  <h1 class="text-2xl font-bold mt-7"><%= Job.name @job %></h1>

  <h2 class="mt-5 text-xs font-bold uppercase">Lead Details</h2>
  <button title="Edit Lead" type="button" phx-click="edit-job" class="btn-row mt-2">
    <%= Job.name @job %>
    <%= icon_tag(@socket, "forth", class: "stroke-current h-6 w-6") %>
  </button>

  <%= if @package do %>
    <h2 class="mt-4 text-xs font-bold uppercase">Package Details</h2>

    <button title="Edit package" type="button" phx-click="edit-package" class="btn-row mt-2">
      <%= @package.name %>
      <%= icon_tag(@socket, "forth", class: "stroke-current h-6 w-6") %>
    </button>

    <h2 class="pt-4 mb-2 text-xs font-bold uppercase">Shoot Details</h2>

    <%= for {shoot_number, shoot} <- @shoots do %>
      <%= if shoot do %>
        <button title="Edit shoot" type="button" phx-click="edit-shoot-details" phx-value-shoot-number="<%= shoot_number %>" phx-value-shoot-id="<%= shoot.id %>" class="btn-row mb-3">
          <%= shoot.name %>
          <%= icon_tag(@socket, "forth", class: "stroke-current h-6 w-6") %>
        </button>
      <% else %>
        <div class="flex flex-col items-center p-6 mb-3 bg-gray-100 rounded-2xl">
          <div>Shoot <%= shoot_number %></div>
          <a href="#" phx-click="edit-shoot-details" phx-value-shoot-number="<%= shoot_number %>" class="link">Add shoot details</a>
        </div>
      <% end %>
    <% end %>

    <h2 class="mt-4 text-xs font-bold uppercase">Booking Details</h2>

    <p class="mt-4 text-sm font-bold">Add additional details to be included with the booking proposal</p>

    <label class="flex mt-4">
      <input type="checkbox" class="mt-1 checkbox" />
      <div class="pl-2">
        <h3 class="input-label">Include questionnaire</h3>
      </div>
    </label>

    <%= live_render @socket, PicselloWeb.StripeOnboardingLive, id: :stripe_onboarding, session: %{"return_url" => @socket |> Routes.job_url(:show, @job.id)} %>

    <label class="block mt-8 input-label" for="contract_type">Contract type</label>
    <select id="contract_type" class="w-full select"><option>Standard Contract</option></select>

    <hr class="mt-8 border-gray-500"/>

    <% shoots_completed = @package.shoot_count == Enum.count(@shoots, &elem(&1, 1)) %>
    <% send_proposal_enabled = @stripe_status == :charges_enabled && shoots_completed %>
    <button class="w-full mt-6 btn-primary" phx-click="send-proposal" <%= if !send_proposal_enabled, do: "disabled" %>>Send Booking Proposal</button>
    <%= if !shoots_completed do %>
      <em class="block pt-2 text-xs text-center">add shoot details first</em>
    <% end %>

  <% else %>
    <button type="button" phx-click="add-package" class="w-full mt-8 text-center uppercase btn-primary">
      Add a package
    </button>
  <% end %>
</div>
